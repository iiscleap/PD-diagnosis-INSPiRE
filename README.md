# Audio Feature Extraction and Prediction for the INSPiRE datset for the Journal article "Phonetic Onset as Digital Biomarker for Parkinson’s Disease"

This repository contains scripts for audio feature extraction and prediction tasks, focusing on traditional signal processing and HuBERT-based feature extraction for full and transition audio segments.


## Folder Structure design used in the repository scripts

The scripts assume the following folder structure for input audio files:

```
Parent_folder/
├── Speaking_task_1/
│   ├── audio1.wav
│   ├── audio2.wav
│   └── ...
├── Speaking_task_2/
│   ├── audio1.wav
│   ├── audio2.wav
│   └── ...
└── ...
```
---

## Repository Overview

### Scripts and Their Functionality

1. **`audio_silence_extarctor.py`**
   - **Description**: Extracts audio from videos, resamples to 16kHz, and removes beginning and trailing silences (defined as audio with amplitude < 0.1% of the maximum amplitude).
   - **Usage**: Run `python audio_silence_extarctor.py --help` to view available options.

2. **`transition_extractor.py`**
   - **Description**: Extracts transition segments from audio files using a window size of `2*window_size` (specified in options). Processed audios are saved to `output_dir/all_combined_wavs`.
   - **Usage**: Run `python transition_extractor.py --help` to view available options.

3. **`audio_feature_extractor.py`**
   - **Description**: Performs traditional signal processing feature extraction for full audio files. Available feature sets can be viewed using the help option.
   - **Usage**: Run `python audio_feature_extractor.py --help` to view available options.

4. **`transition_audio_feature_extractor.py`**
   - **Description**: Performs traditional signal processing feature extraction for transition audio segments (generated by `transition_extractor.py`). Available feature sets can be viewed using the help option.
   - **Usage**: Run `python transition_audio_feature_extractor.py --help` to view available options.

5. **`hubert_audio_feature_extractor.py`**
   - **Description**: Extracts HuBERT features for either full or transition audios, determined by the `use_transition_audios` flag (`1` for transition audios, `0` for full audios).
   - **Usage**: Run `python hubert_audio_feature_extractor.py --help` to view available options.

6. **`traditional_full_audio_predictions.py`**
   - **Description**: Generates predictions using traditional signal processing features for full audio files.
   - **Usage**: Run `python traditional_full_audio_predictions.py --help` to view available options.

7. **`hubert_transition_audio_predictions.py`**
   - **Description**: Generates predictions using HuBERT features for transition audio segments.
   - **Usage**: Run `python hubert_transition_audio_predictions.py --help` to view available options.

---

---

## Getting Started

### 1. Clone the Repository

```bash
git clone https://github.com/iiscleap/PD-diagnosis-INSPiRE.git
cd PD-diagnosis-INSPiRE
```

### 2. Install Dependencies

Ensure you have Python 3.x installed. Install required dependencies using:

```bash
pip install -r requirements.txt
```

### 3. Running Scripts

Each script can be executed with specific options. Use the `--help` flag to view available options for each script. Example:

```bash
python audio_silence_extarctor.py --help
```

## Notes

- Ensure that input audio files are in `.wav` format (taken care of if using the audio_silence_extarctor.py script) and organized as per the folder structure described above.
- device flag can be used to mention what device to use (GPU or CPU) for the HuBERT model where required.
- Some dataset specific changes might have to be made when using a different dataset based on the naming convention of the files.

---

## License

This project is licensed under the MIT License. See the `LICENSE` file for details.
